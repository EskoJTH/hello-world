--Ei toimi
subgroup :: Eq a=>[a]->[a]
subgroup xs =findOccurance ys zs where
  ys = take (div (length xs) 2) xs
  zs = drop (div (length xs) 2) xs
findOccurance :: Eq a=>[a]->[a]->[a]
findOccurance [] xs = []
findOccurance (x:xs) ys= case (partOf (x:xs) ys) of
  [] -> findOccurance xs ys
  x -> x
  
partOf :: Eq a=>[a]->[a]->[a]
partOf xs [] = []
partOf xs [y] = []
partOf (xs) (y:ys)
  |same (xs) (y:ys) = (xs)
  |otherwise = partOf (xs) ys
same [] y = True 
same x [] = False
same (x:xs) (y:ys)
  | x==y = same xs ys
  | otherwise = False

numbers' :: [Double]
numbers' = [9.9, 2.1, 3.3, 9.9, 2.1, 3.3, 2,2]

numbers'' = [1,2,7,7,3,4,5,6,2,7,2,1]

kaikkiLapi x = kaikkiLapi' x x - length x
kaikkiLapi' [] ys = 0
kaikkiLapi' (x:xs) ys = sub x ys + kaikkiLapi' xs ys
sub a [] = 0
sub a (x:xs) = if(x==a)then 1 + sub a xs else sub a xs

--2 joukkueen rastit
tupa2Jr = [12,85,6601880566235136,5627413958492160,4875454842404864,4750123938611200,4828368713285632,4828368713285632,4771528579219456,6653934764556288,6358096477683712,6358096477683712]

--[4.821274903707648e15,6.601880566235136e15,6.601880566235136e15,5.62741395849216e15,4.875454842404864e15,4.7501239386112e15,4.828368713285632e15,4.828368713285632e15,4.771528579219456e15,6.653934764556288e15,6.358096477683712e15,6.358096477683712e15]

mappaus :: Eq a=>[a]->[(a,b)]->[b]
mappaus xs ys = map (\x->(etsi x ys)) xs


etsi ::Eq a=> a-> [(a,b)] ->b
etsi a ((x,y):xs) 
  |a==x = y
  |otherwise = etsi a xs


--lon lat id
--rastit [((String, Double),(String, Double),(String, Double))]
matkat = laskelonlatit (kaikkiMatkat rastit (mappaus tupa2Jr rastinID))

kaikkiMatkat :: [((String, Double),(String, Double),(String, Double))]->[Double]->[(Double,Double)]
kaikkiMatkat xs [] = []
kaikkiMatkat xs (y:ys) = case (nauta y xs) of
  Nothing -> kaikkiMatkat xs ys
  Just (lon,lat) -> (lon,lat):kaikkiMatkat xs ys
nauta y [] = Nothing
nauta y (((a,lon),(c,lat),(e,f)):xs)
  |f == y = Just (lon,lat)
  |otherwise = nauta y xs

laskelonlatit [a] = 0
laskelonlatit (a:b:as) = kahdenpisteenValinenEtaisuus a b + laskelonlatit (b:as)
kahdenpisteenValinenEtaisuus (a,b) (c,d) = getDistanceFromLatLonInKm b a d c


getDistanceFromLatLonInKm lat1 lon1 lat2 lon2 = d where
     r = 6371; -- Radius of the earth in km
     dLat = deg2rad (lat2 - lat1);  -- deg2rad below
     dLon = deg2rad (lon2 - lon1);
     a = sin (dLat / 2) * sin (dLat / 2) + cos (deg2rad(lat1)) * cos (deg2rad(lat2)) * sin (dLon / 2) * sin (dLon/ 2)
     c = 2 * atan2 (sqrt (a)) (sqrt (1 - a))
     d = r * c -- Distance in km

deg2rad deg  = deg * (3.14159265359 / 180)


numbers :: [Double]
numbers = [095269168247325,2.753323482845221,1.5031621947587603,0.7415859978125791,2.680229237874604,2.312845536997212,3.0607819596376244,1.2952870974372201,1.4019087578383018,1.7214869707397458,0.8242451123809321,0.8277231071842082,1.4267265913321183,1.1108414292506577,1.2793920155602319,2.2651159688508793,3.2350196302940386,0.8682037456857432,1.0248967904359032,2.935770280368112,1.6913213694144118,1.1219609427104609,2.2589698593762315,1.1976547149414212,7.7044653131273,0.7427462777727067,1.8881252732831606,3.356532877748284,1.6070137631732238,1.239807910122616,0.959388877670642,1.7484614637281386,1.3420008276718254,1.5924803003027044,6.066228716617652,1.4535742915120333,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,2.5620939866677985,1.2383732819331417,3.7114434592487338,0.7161276029758616,0.9381228566032663,0.7427462777727067,1.2925010466333653,2.9276190144970644,2.2196568056692776,0.8119570742093012,1.170295372953838,1.5274061715111493,2.2366686682780568,1.5924803003027044,1.3420008276718254,1.7484614637281386,0.959388877670642,1.4921883578315311,1.6070137631732238,4.847117641909459,1.1079193997943064,1.3495776999445308,1.9295462271935904,1.281114335766169,1.1030773060262336,2.707871171982252,2.144329414165042,1.2263809896816853,1.2383732819331417,3.27493167885975,1.875950255331682,2.901909919738218,3.4137739816445913,1.2952870974372201,1.6892113742305737,1.0248967904359032,1.8576369575626823,0.8242451123809321,0.8277231071842082,1.4267265913321183,1.6582367064249137,0.649817732551771,1.2793920155602319,2.2651159688508793,2.792175437569334,3.1350918536578796,1.1976547149414212,2.063808190454096,4.4460238381162975,2.39239555714139,0.7128010342941845,2.1287938734788234,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,2.944293018415709,0.9045691323695547,2.3775970835958136,1.7098672054817021,1.5300990912273544,1.2952870974372201,1.9045103354157122,1.031829467302879,3.2129652658766563,0.7227996994691488,1.388540580525888,1.8392653298993689,0.8242451123809321,0.8277231071842082,1.2470362676057567,2.4751086265189115,1.1108414292506577,1.2793920155602319,1.0977346118800824,0.8682037456857432,1.0248967904359032,3.151385310045691,0.6209622835026486,1.4350067029674116,1.795292247349141,1.7519653103295216,1.1219609427104609,2.901909919738218,0.7191658355419299,1.1976547149414212,4.828614250149971,2.1894517862562766,1.1623797805888263,0.7161276029758616,1.8095269168247325,2.661809566762953,2.3615987289188163,1.1976547149414212,2.2589698593762315,1.1219609427104609,1.6913213694144118,2.0493659817372647,1.0507736410216773,1.0248967904359032,0.8682037456857432,1.0977346118800824,1.2793920155602319,1.1108414292506577,1.4267265913321183,0.8277231071842082,0.8242451123809321,1.8392653298993689,1.388540580525888,0.7227996994691488,3.9011713110330763,1.2952870974372201,1.5300990912273544,4.028664485470449,2.944293018415709,1.5031621947587603,2.39239555714139,1.348585472388631,1.2383732819331417,4.234210238053526,1.9295462271935904,1.3495776999445308,3.803668195522989,1.6070137631732238,1.4921883578315311,0.959388877670642,1.7484614637281386,1.3420008276718254,1.5924803003027044,2.2366686682780568,2.156314390182348,2.577705424053987,1.0846663933971168,1.1623797805888263,0.4981886569632334,1.8095269168247325,0.7128010342941845,1.348585472388631,1.2383732819331417,1.2263809896816853,2.144329414165042,0.7792796927437502,2.03153241499909,1.1030773060262336,1.7832169391350825,1.1079193997943064,5.1897094060398254,1.0683735026886787,1.6070137631732238,1.4921883578315311,0.959388877670642,1.623269232874949,2.2196568056692776,1.8881252732831606,0.7427462777727067,0.7161276029758616,1.8095269168247325,2.661809566762953,2.3615987289188163,1.1976547149414212,1.6619399362132383,1.7519653103295216,1.1219609427104609,1.6913213694144118,2.0493659817372647,1.0507736410216773,1.0248967904359032,0.8682037456857432,1.0977346118800824,1.2793920155602319,1.1108414292506577,1.4267265913321183,0.8277231071842082,0.8242451123809321,1.7214869707397458,1.4019087578383018,1.2952870974372201,1.5300990912273544,4.028664485470449,1.5940434990233603,1.875950255331682,0.7415859978125791,2.534668053806742,4.234210238053526,1.9295462271935904,4.4393220522228365,1.6070137631732238,2.1585276369844784,1.7484614637281386,7.075481061172045,1.4535742915120333,1.7969684928059673,2.577705424053987,2.251422990173376,2.472974649454895,1.7484614637281386,0.959388877670642,1.4921883578315311,1.6070137631732238,3.803668195522989,1.3495776999445308,1.9295462271935904,3.004501368912811,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,1.875950255331682,0.7191658355419299,1.1976547149414212,3.1350918536578796,1.1219609427104609,1.6913213694144118,2.0493659817372647,1.0507736410216773,1.0248967904359032,0.8682037456857432,1.0977346118800824,1.2793920155602319,1.1108414292506577,1.4267265913321183,0.8277231071842082,0.8242451123809321,1.8392653298993689,3.548161500437107,1.4019087578383018,1.2952870974372201,1.5300990912273544,1.88159535068135,2.312845536997212,2.680229237874604,2.534668053806742,3.0532925506678015,1.1924445064901132,1.848895421051334,1.1079193997943064,3.803668195522989,1.6070137631732238,3.356532877748284,1.8881252732831606,1.4340214613332418,2.0335628468849767,0.7128010342941845,2.0332198123350134,1.115089387133739,2.2460757314875415,0.6461571977774765,3.803417017683949,4.073886040450833,2.2366686682780568,1.5924803003027044,1.3420008276718254,1.7484614637281386,0.959388877670642,1.4921883578315311,1.6070137631732238,3.803668195522989,1.7832169391350825,2.0701233461285242,2.1330110506733098,1.5177863770888556,0.7161276029758616,0.35390968028312586,1.8095269168247325,2.661809566762953,2.3615987289188163,1.8198376841207253,1.7519653103295216,1.1219609427104609,0.8060820331399342,2.312845536997212,2.944293018415709,1.5031621947587603,2.39239555714139,2.38484719844796,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,0.7415859978125791,1.6786641221298397,2.4385098494624833,1.5940434990233603,2.901909919738218,0.8060820331399342,1.88159535068135,1.5300990912273544,1.2952870974372201,2.622806895253323,2.5520815332572977,2.990922659472447,3.1758397526945132,2.8358240568772866,1.7214869707397458,0.8242451123809321,0.8277231071842082,1.4267265913321183,1.1108414292506577,1.2793920155602319,2.2651159688508793,3.2350196302940386,0.8682037456857432,1.0248967904359032,4.787885255638189,3.1350918536578796,7.101573123456718,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,2.944293018415709,1.5940434990233603,0.7191658355419299,1.1976547149414212,2.3615987289188163,4.790146286550095,1.8095269168247325,0.7128010342941845,2.39239555714139,1.5031621947587603,0.7415859978125791,2.680229237874604,4.028664485470449,2.500252980757274,3.4137739816445913,2.0301116488316944,0.9023528724369108,3.7306504396381484,1.388540580525888,1.8392653298993689,1.8576369575626823,1.0248967904359032,0.8751226837801103,2.0164429772907755,0.8277231071842082,1.4267265913321183,1.1108414292506577,1.2793920155602319,2.2651159688508793,2.792175437569334,3.1350918536578796,1.1976547149414212,0.7191658355419299,7.844874730005319,1.1623797805888263,0.7161276029758616,1.6570887199865523,2.703939291351717,1.2383732819331417,1.2263809896816853,2.144329414165042,0.7792796927437502,2.03153241499909,1.1030773060262336,1.2295894907485483,1.1079193997943064,3.803668195522989,1.6070137631732238,1.8658641120583896,0.7436368686829912,0.959388877670642,1.7484614637281386,1.3420008276718254,4.235817667073785,2.2196568056692776,1.8881252732831606,0.7427462777727067,2.7285924011880045,0.7128010342941845,2.4299082571544384,0.4981886569632334,0.9381228566032663,0.7427462777727067,1.2925010466333653,1.3104296460949811,1.5732769158054147,2.0701233461285242,1.3799172871632532,1.3495776999445308,1.1079193997943064,5.1897094060398254,1.0683735026886787,1.6070137631732238,2.1585276369844784,1.7484614637281386,1.3420008276718254,8.972484392376277,0.6390785124978141,2.0332198123350134,0.7128010342941845,2.39239555714139,1.5031621947587603,1.875950255331682,0.7191658355419299,1.1976547149414212,3.1350918536578796,1.1219609427104609,2.309186071891577,2.680229237874604,2.534668053806742,1.2383732819331417,2.703939291351717,2.9276190144970644,1.8881252732831606,2.9757819025311316,2.577705424053987,1.0846663933971168,0.7161276029758616,1.8095269168247325,0.7128010342941845,1.348585472388631,1.2383732819331417,1.2263809896816853,2.144329414165042,1.6026716547607522,1.1924445064901132,1.1030773060262336,1.281114335766169,1.3104296460949811,1.2925010466333653,0.7427462777727067,1.0846663933971168,1.615633119700404,0.4981886569632334]

  
--rastin_id:t
rastinID = [(0,0),(7,4750123938611200),(9,4771528579219456),(11,4810425279447040),(12,4821274903707648),(13,4828368713285632),(14,4854848931495936),(15,4875454842404864),(19,4967437606846464),(22,5076239463219200),(27,5209879383900160),(35,5373375232868352),(38,5466832647487488),(43,5627413958492160),(49,5811862536978432),(57,6001354749247488),(62,6110969428180992),(65,6202139370061824),(73,6358096477683712),(76,6439872654999552),(84,6601115927838720),(85,6601880566235136),(86,6653934764556288),(5795146524262400, 5795146524262400),(6029782600908800, 6029782600908800),(6020720354131968, 6020720354131968),(4821274903707648, 4821274903707648),(5232196570841088, 5232196570841088),(5936325186289664, 5936325186289664),(5739141090246656, 5739141090246656),(6439872654999552, 6439872654999552),(4967437606846464, 4967437606846464),(5209879383900160, 5209879383900160),(6305800419016704, 6305800419016704),(5920664393351168, 5920664393351168),(5357714439929856, 5357714439929856),(5720036136189952, 5720036136189952),(5876922701578240, 5876922701578240),(4642982221316096, 4642982221316096),(5064464005070848, 5064464005070848),(5627413958492160, 5627413958492160),(4669246617419776, 4669246617419776),(4913030705971200, 4913030705971200),(5475980659392512, 5475980659392512),(6498833966039040, 6498833966039040),(6190363911913472, 6190363911913472),(6110969428180992, 6110969428180992),(5445149236658176, 5445149236658176),(6001354749247488, 6001354749247488),(6358096477683712, 6358096477683712),(5417798884917248, 5417798884917248),(5373375232868352, 5373375232868352),(5248912583557120, 5248912583557120),(5876023845453824, 5876023845453824),(5548019474759680, 5548019474759680),(5680515860398080, 5680515860398080),(5665699833839616, 5665699833839616),(6374812490399744, 6374812490399744),(4894820447289344, 4894820447289344),(4854848931495936, 4854848931495936),(4750123938611200, 4750123938611200),(6335779290742784, 6335779290742784),(6202139370061824, 6202139370061824),(5102749880418304, 5102749880418304),(4985069521338368, 4985069521338368),(5076239463219200, 5076239463219200),(6592732554330112, 6592732554330112),(6683675802468352, 6683675802468352),(6228649787260928, 6228649787260928),(5897428486062080, 5897428486062080),(5811862536978432, 5811862536978432),(4613241183404032, 4613241183404032),(5313972748156928, 5313972748156928),(4875454842404864, 4875454842404864),(6460378439483392, 6460378439483392),(5091900256157696, 5091900256157696),(4828368713285632, 4828368713285632),(5844366849474560, 5844366849474560),(4928404407189504, 4928404407189504),(6471838888624128, 6471838888624128),(6214128637050880, 6214128637050880),(5176191136825344, 5176191136825344),(5373190012403712, 5373190012403712),(6392444404891648, 6392444404891648),(4554615953555456, 4554615953555456),(6653934764556288, 6653934764556288),(5334478532640768, 5334478532640768),(6601115927838720, 6601115927838720),(4741461794881536, 4741461794881536),(6090984811134976, 6090984811134976),(4763145205710848, 4763145205710848),(6579711287230464, 6579711287230464),(4810425279447040, 4810425279447040),(4771528579219456, 4771528579219456),(6529450237755392, 6529450237755392),(5266544498049024, 5266544498049024),(6601880566235136, 6601880566235136),(6217800163000320, 6217800163000320),(5557775895625728, 5557775895625728),(5528034857713664, 5528034857713664),(6235743596838912, 6235743596838912),(5466832647487488, 5466832647487488),(6038930612813824, 6038930612813824),(4685962630135808, 4685962630135808),(5179900512174080, 5179900512174080)]

--rastit = [((String, Double),(String, Double),(String, Double),(String, Double),(String, Double))]
rastit = [(("lon", 25.542413),("lat", 62.120776), ("id", 4554615953555456)),(("lon", 25.496872),("lat", 62.156532), ("id", 4613241183404032)),(("lon", 25.714338),("lat", 62.112172), ("id", 4642982221316096)),(("lon", 25.544984),("lat", 62.099795), ("id", 4669246617419776)),(("lon", 25.737019),("lat", 62.133029), ("id", 4685962630135808)),(("lon", 25.518665),("lat", 62.110562), ("id", 4741461794881536)),(("lon", 25.615203),("lat", 62.115047), ("id", 4750123938611200)),(("lon", 25.729848),("lat", 62.088183), ("id", 4763145205710848)),(("lon", 25.644512),("lat", 62.111830), ("id", 4771528579219456)),(("lon", 25.618079),("lat", 62.148123), ("id", 4794764486508544)),(("lon", 25.605762),("lat", 62.134681), ("id", 4810425279447040)),(("lon", 25.666688),("lat", 62.130280), ("id", 4821274903707648)),(("lon", 25.635950),("lat", 62.103930), ("id", 4828368713285632)),(("lon", 25.573049),("lat", 62.122986), ("id", 4854848931495936)),(("lon", 25.628228),("lat", 62.119060), ("id", 4875454842404864)),(("lon", 25.652877),("lat", 62.089674), ("id", 4894820447289344)),(("lon", 25.626533),("lat", 62.129767), ("id", 4913030705971200)),(("lon", 25.695688),("lat", 62.086189), ("id", 4928404407189504)),(("lon", 25.597278),("lat", 62.127323), ("id", 4967437606846464)),(("lon", 25.628236),("lat", 62.095187), ("id", 4985069521338368)),(("lon", 25.509358),("lat", 62.141243), ("id", 5064464005070848)),(("lon", 25.668097),("lat", 62.136462), ("id", 5076239463219200)),(("lon", 25.540227),("lat", 62.153864), ("id", 5091900256157696)),(("lon", 25.673997),("lat", 62.102194), ("id", 5102749880418304)),(("lon", 25.493141),("lat", 62.144852), ("id", 5176191136825344)),(("lon", 25.718561),("lat", 62.118784), ("id", 5179900512174080)),(("lon", 25.678314),("lat", 62.121247), ("id", 5209879383900160)),(("lon", 25.553191),("lat", 62.111294), ("id", 5232196570841088)),(("lon", 25.691051),("lat", 62.098636), ("id", 5248912583557120)),(("lon", 25.733259),("lat", 62.078212), ("id", 5266544498049024)),(("lon", 25.535011),("lat", 62.139918), ("id", 5313972748156928)),(("lon", 25.562520),("lat", 62.138397), ("id", 5334478532640768)),(("lon", 25.680401),("lat", 62.091567), ("id", 5357714439929856)),(("lon", 25.498431),("lat", 62.132320), ("id", 5373190012403712)),(("lon", 25.577610),("lat", 62.132964), ("id", 5373375232868352)),(("lon", 25.590916),("lat", 62.142319), ("id", 5417798884917248)),(("lon", 25.507110),("lat", 62.151460), ("id", 5445149236658176)),(("lon", 25.704639),("lat", 62.126591), ("id", 5466832647487488)),(("lon", 25.665822),("lat", 62.147298), ("id", 5475980659392512)),(("lon", 25.558017),("lat", 62.125561), ("id", 5528034857713664)),(("lon", 25.671071),("lat", 62.087827), ("id", 5548019474759680)),(("lon", 25.563169),("lat", 62.147942), ("id", 5557775895625728)),(("lon", 25.649234),("lat", 62.124222), ("id", 5627413958492160)),(("lon", 25.586932),("lat", 62.100104), ("id", 5665699833839616)),(("lon", 25.528730),("lat", 62.153364), ("id", 5680515860398080)),(("lon", 25.522034),("lat", 62.099512), ("id", 5720036136189952)),(("lon", 25.750133),("lat", 62.126639), ("id", 5739141090246656)),(("lon", 25.718473),("lat", 62.141674), ("id", 5795146524262400)),(("lon", 25.613440),("lat", 62.107914), ("id", 5811862536978432)),(("lon", 25.716227),("lat", 62.093545), ("id", 5844366849474560)),(("lon", 25.565572),("lat", 62.101185), ("id", 5876023845453824)),(("lon", 25.560594),("lat", 62.153435), ("id", 5876922701578240)),(("lon", 25.647515),("lat", 62.094680), ("id", 5897428486062080)),(("lon", 25.728135),("lat", 62.100413), ("id", 5920664393351168)),(("lon", 25.540316),("lat", 62.131251), ("id", 5936325186289664)),(("lon", 25.597308),("lat", 62.149572), ("id", 5980748838338560)),(("lon", 25.682473),("lat", 62.134123), ("id", 6001354749247488)),(("lon", 25.728800),("lat", 62.109962), ("id", 6020720354131968)),(("lon", 25.569589),("lat", 62.115924), ("id", 6029782600908800)),(("lon", 25.523811),("lat", 62.135094), ("id", 6038930612813824)),(("lon", 25.513792),("lat", 62.147825), ("id", 6090984811134976)),(("lon", 25.668757),("lat", 62.113906), ("id", 6110969428180992)),(("lon", 25.628636),("lat", 62.141654), ("id", 6120725849047040)),(("lon", 25.686679),("lat", 62.081466), ("id", 6190363911913472)),(("lon", 25.589347),("lat", 62.108717), ("id", 6202139370061824)),(("lon", 25.645642),("lat", 62.146315), ("id", 6214128637050880)),(("lon", 25.732937),("lat", 62.095246), ("id", 6217800163000320)),(("lon", 25.576022),("lat", 62.149229), ("id", 6228649787260928)),(("lon", 25.531059),("lat", 62.123662), ("id", 6235743596838912)),(("lon", 25.526039),("lat", 62.142258), ("id", 6305800419016704)),(("lon", 25.694017),("lat", 62.144101), ("id", 6320405589524480)),(("lon", 25.496020),("lat", 62.125632), ("id", 6335779290742784)),(("lon", 25.669574),("lat", 62.131769), ("id", 6358096477683712)),(("lon", 25.743788),("lat", 62.115241), ("id", 6374812490399744)),(("lon", 25.606234),("lat", 62.093203), ("id", 6392444404891648)),(("lon", 25.694911),("lat", 62.117266), ("id", 6439872654999552)),(("lon", 25.519131),("lat", 62.156431), ("id", 6460378439483392)),(("lon", 25.531926),("lat", 62.147942), ("id", 6471838888624128)),(("lon", 25.724837),("lat", 62.128162), ("id", 6498833966039040)),(("lon", 25.524245),("lat", 62.118778), ("id", 6529450237755392)),(("lon", 25.503483),("lat", 62.115914), ("id", 6571049143500800)),(("lon", 25.648821),("lat", 62.140919), ("id", 6579711287230464)),(("lon", 25.661916),("lat", 62.094023), ("id", 6592732554330112)),(("lon", 25.599044),("lat", 62.120424), ("id", 6601115927838720)),(("lon", 25.650436),("lat", 62.131207), ("id", 6601880566235136)),(("lon", 25.674748),("lat", 62.127514), ("id", 6653934764556288)),(("lon", 25.687644),("lat", 62.107580), ("id", 6683675802468352))]
